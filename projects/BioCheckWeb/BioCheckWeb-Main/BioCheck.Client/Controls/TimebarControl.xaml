<UserControl x:Class="BioCheck.Controls.TimebarControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"   
             
    xmlns:Controls="clr-namespace:BioCheck.Controls" xmlns:Views="clr-namespace:BioCheck.Views" mc:Ignorable="d" d:DesignWidth="230">

    <UserControl.Resources>

        <DataTemplate x:Name="DropAllowedTemplate">

            <ContentControl 
                Width="50"
                Height="50">
                <Path Data="F1M111.5029,45.1035000000001C115.0089,45.7465000000001,118.3989,45.6785000000001,120.3439,43.9215000000001C122.4599,42.0115000000001,122.7899,40.1125000000001,122.0229,39.2245000000001C121.0549,38.1045000000001,118.2619,38.3715000000001,114.9939,41.0715000000001C113.4509,42.3435000000001,112.2749,43.7205000000001,111.5029,45.1035000000001 M116.6689,54.7685000000001C118.6539,54.9895,121.0509,54.6675000000001,123.7519,53.5355000000001C126.2129,52.5025000000001,127.1019,50.8015000000001,126.8679,50.2165000000001C126.6809,49.7485000000001,124.9339,49.2295000000001,120.9629,50.7375000000001C118.6519,51.6155000000001,117.2919,53.1255000000001,116.6689,54.7685000000001 M121.8639,63.3585C122.8819,63.5125000000001,124.0289,63.4795000000001,125.2989,63.2065000000001C129.5669,62.2915000000001,130.9839,60.6835000000001,131.1369,59.9605000000001C131.1729,59.7885000000001,131.1539,59.6595000000001,130.9459,59.5075000000001C130.3119,59.0475000000001,128.1579,58.7255000000001,124.5479,60.8055000000001C123.2829,61.5345000000001,122.3749,62.4055000000001,121.8639,63.3585 M128.7569,75.0725L127.7779,74.7165000000001C122.3369,72.7425,119.0319,69.4905000000001,118.7089,65.7945000000001C118.6909,65.5885000000001,118.6829,65.3825000000001,118.6839,65.1785000000001C116.2199,63.9885000000001,114.5869,61.8515000000001,113.9249,59.6085000000001C113.6609,58.7155000000001,113.5299,57.7545000000001,113.5529,56.7775000000001C111.4289,55.9865,109.8249,54.6375000000001,108.8809,53.0755000000001C107.9399,51.5175000000001,107.4509,49.3985000000001,107.9159,47.0325000000001C104.9019,46.2045000000001,102.2419,45.1035000000001,100.7079,44.4145000000001L97.3499,53.4135000000001L109.4439,56.9835000000001L108.6809,59.5705000000001L93.8109,55.1805000000001L99.2199,40.6885000000001L100.5639,41.3655000000001C102.3099,42.2445000000001,105.4369,43.5705000000001,108.7729,44.4765000000001C109.6279,42.6805000000001,111.0679,40.8125000000001,113.2759,38.9905000000001C118.1589,34.9585000000001,122.2119,35.3175000000001,124.0649,37.4615000000001C125.6389,39.2845000000001,125.7109,42.7095000000001,122.1519,45.9225000000001C119.3179,48.4825000000001,114.8069,48.4955000000001,110.5389,47.6545000000001C110.2609,49.0975000000001,110.4629,50.4785000000001,111.1899,51.6805000000001C111.7779,52.6535000000001,112.7429,53.5025000000001,114.0249,54.0735000000001C114.8339,51.6765000000001,116.7159,49.4655000000001,120.0049,48.2155000000001C127.2289,45.4715000000001,129.0009,48.2875000000001,129.3729,49.2155000000001C130.3099,51.5615000000001,128.2999,54.5515000000001,124.7949,56.0225000000001C121.5989,57.3615,118.7089,57.7225000000001,116.2649,57.4285000000001C116.2949,57.9165000000001,116.3779,58.3935000000001,116.5119,58.8445000000001C116.9339,60.2735000000001,117.8789,61.5985000000001,119.3039,62.4565000000001C120.0239,60.9105000000001,121.3529,59.5325000000001,123.2019,58.4675000000001C127.6869,55.8865000000001,130.9619,56.1855000000001,132.5319,57.3265000000001C133.5739,58.0835000000001,134.0389,59.2775000000001,133.7759,60.5195000000001C133.2719,62.8995000000001,130.3149,64.8905000000001,125.8649,65.8445000000001C124.2549,66.1885000000001,122.7839,66.2275,121.4649,66.0285000000001C121.9199,68.2315000000001,124.1989,70.3305000000001,127.7329,71.8055000000001L131.0779,66.9545000000001L138.9509,71.5505000000001L137.5919,73.8795000000001L131.8789,70.5455000000001z" Fill="#FFEE4036" Height="39.183" Stretch="Fill" UseLayoutRounding="False" Width="45.14" Margin="5"/>
            </ContentControl>

        </DataTemplate>

    </UserControl.Resources>

    <StackPanel 
            x:Name="timebarPanel"
            Orientation="Horizontal"
            VerticalAlignment="Bottom">

        <!--ToolTipService.ToolTip="Container"-->

        <Controls:TimebarItem
            FixedHeight="64"
            FixedWidth="58" 
            ToolTipService.ToolTip="Less than">
            
            <!-- Drags the full popup around, unless stuck to a wall, in which case I can drag the rectangle around.
            And the nested shadow doesn't support this.
            <i:Interaction.Behaviors>
                <ei:MouseDragElementBehavior/>                
            </i:Interaction.Behaviors>
            -->
            <Controls:TimebarItem.Command>
                <Controls:TimebarCommand TimeCommandType="LessThan" />
            </Controls:TimebarItem.Command>
            <Controls:TimebarItem.Content>
                <!-- Below path is for the button image. -->
                <Path 
                    Data="M21,0.5 L25.8391,15.779 L41.5,15.7786 L28.8299,25.2212 L33.6697,40.5 L21,31.0568 L8.3303,40.5 L13.1701,25.2212 L0.5,15.7786 L16.1609,15.779 z" Fill="#FFF5DB37" HorizontalAlignment="Left" Height="34" Stretch="Fill" Stroke="Black" UseLayoutRounding="False" VerticalAlignment="Top" Width="44"/>

                <!--
                <Path Data="F1M73.23,106.708C66.835,106.708,61.633,100.267,61.633,92.349C61.633,84.432,66.835,77.99,73.23,77.99C79.624,77.99,84.826,84.432,84.826,92.349C84.826,100.267,79.624,106.708,73.23,106.708 M73.23,76.504C64.783,76.504,57.937,83.599,57.937,92.349C57.937,101.099,64.783,108.193,73.23,108.193C80.454,108.193,86.312,101.099,86.312,92.349C86.312,83.599,80.454,76.504,73.23,76.504" Fill="#FFFAAF40" Height="31.689" Stretch="Fill" Width="28.375" UseLayoutRounding="False"/>
                -->
            </Controls:TimebarItem.Content>
            <Controls:TimebarItem.CursorTemplate>
                <DataTemplate>
                    <!-- Below path is for the shadow. -->
                    
                    <!-- Star, but not centered on the cursor..  Using the cell temporarily instead.
                    <Path Data="M21,0.5 L25.8391,15.779 L41.5,15.7786 L28.8299,25.2212 L33.6697,40.5 L21,31.0568 L8.3303,40.5 L13.1701,25.2212 L0.5,15.7786 L16.1609,15.779 z" Fill="#FFF5DB37" Height="34" Stretch="Fill" Stroke="Black" UseLayoutRounding="False" Width="44" Opacity="0.6"/>
                     -->
                    
                    
                    <Path Data="F1M51.834,75.582C43.225,75.582,36.221,66.91,36.221,56.251C36.221,45.591,43.225,36.919,51.834,36.919C60.442,36.919,67.445,45.591,67.445,56.251C67.445,66.91,60.442,75.582,51.834,75.582 M51.834,34.919C40.461,34.919,31.244,44.471,31.244,56.251C31.244,68.031,40.461,77.582,51.834,77.582C61.559,77.582,69.445,68.031,69.445,56.251C69.445,44.471,61.559,34.919,51.834,34.919" Fill="#FFFAAF40" 
                          Height="64" Stretch="Fill" Width="58" UseLayoutRounding="False"/>
                   
                </DataTemplate>
            </Controls:TimebarItem.CursorTemplate>
        </Controls:TimebarItem>

        <!-- FixedHeight/Width has to do with the shadow: Larger means more area can it go. The path width is the actual drawing's width. Having no fixed width/height is as bad as having it. -->
        <Controls:TimebarItem
                 FixedHeight="36"
                 FixedWidth="42"
                 ToolTipService.ToolTip="More than"
                Margin="5,0,0,0">
            <Controls:TimebarItem.Command>
                <Controls:TimebarCommand TimeCommandType="MoreThan" />
            </Controls:TimebarItem.Command>
            <Controls:TimebarItem.Content>
                <Path Data="F1M111.5029,45.1035000000001C115.0089,45.7465000000001,118.3989,45.6785000000001,120.3439,43.9215000000001C122.4599,42.0115000000001,122.7899,40.1125000000001,122.0229,39.2245000000001C121.0549,38.1045000000001,118.2619,38.3715000000001,114.9939,41.0715000000001C113.4509,42.3435000000001,112.2749,43.7205000000001,111.5029,45.1035000000001 M116.6689,54.7685000000001C118.6539,54.9895,121.0509,54.6675000000001,123.7519,53.5355000000001C126.2129,52.5025000000001,127.1019,50.8015000000001,126.8679,50.2165000000001C126.6809,49.7485000000001,124.9339,49.2295000000001,120.9629,50.7375000000001C118.6519,51.6155000000001,117.2919,53.1255000000001,116.6689,54.7685000000001 M121.8639,63.3585C122.8819,63.5125000000001,124.0289,63.4795000000001,125.2989,63.2065000000001C129.5669,62.2915000000001,130.9839,60.6835000000001,131.1369,59.9605000000001C131.1729,59.7885000000001,131.1539,59.6595000000001,130.9459,59.5075000000001C130.3119,59.0475000000001,128.1579,58.7255000000001,124.5479,60.8055000000001C123.2829,61.5345000000001,122.3749,62.4055000000001,121.8639,63.3585 M128.7569,75.0725L127.7779,74.7165000000001C122.3369,72.7425,119.0319,69.4905000000001,118.7089,65.7945000000001C118.6909,65.5885000000001,118.6829,65.3825000000001,118.6839,65.1785000000001C116.2199,63.9885000000001,114.5869,61.8515000000001,113.9249,59.6085000000001C113.6609,58.7155000000001,113.5299,57.7545000000001,113.5529,56.7775000000001C111.4289,55.9865,109.8249,54.6375000000001,108.8809,53.0755000000001C107.9399,51.5175000000001,107.4509,49.3985000000001,107.9159,47.0325000000001C104.9019,46.2045000000001,102.2419,45.1035000000001,100.7079,44.4145000000001L97.3499,53.4135000000001L109.4439,56.9835000000001L108.6809,59.5705000000001L93.8109,55.1805000000001L99.2199,40.6885000000001L100.5639,41.3655000000001C102.3099,42.2445000000001,105.4369,43.5705000000001,108.7729,44.4765000000001C109.6279,42.6805000000001,111.0679,40.8125000000001,113.2759,38.9905000000001C118.1589,34.9585000000001,122.2119,35.3175000000001,124.0649,37.4615000000001C125.6389,39.2845000000001,125.7109,42.7095000000001,122.1519,45.9225000000001C119.3179,48.4825000000001,114.8069,48.4955000000001,110.5389,47.6545000000001C110.2609,49.0975000000001,110.4629,50.4785000000001,111.1899,51.6805000000001C111.7779,52.6535000000001,112.7429,53.5025000000001,114.0249,54.0735000000001C114.8339,51.6765000000001,116.7159,49.4655000000001,120.0049,48.2155000000001C127.2289,45.4715000000001,129.0009,48.2875000000001,129.3729,49.2155000000001C130.3099,51.5615000000001,128.2999,54.5515000000001,124.7949,56.0225000000001C121.5989,57.3615,118.7089,57.7225000000001,116.2649,57.4285000000001C116.2949,57.9165000000001,116.3779,58.3935000000001,116.5119,58.8445000000001C116.9339,60.2735000000001,117.8789,61.5985000000001,119.3039,62.4565000000001C120.0239,60.9105000000001,121.3529,59.5325000000001,123.2019,58.4675000000001C127.6869,55.8865000000001,130.9619,56.1855000000001,132.5319,57.3265000000001C133.5739,58.0835000000001,134.0389,59.2775000000001,133.7759,60.5195000000001C133.2719,62.8995000000001,130.3149,64.8905000000001,125.8649,65.8445000000001C124.2549,66.1885000000001,122.7839,66.2275,121.4649,66.0285000000001C121.9199,68.2315000000001,124.1989,70.3305000000001,127.7329,71.8055000000001L131.0779,66.9545000000001L138.9509,71.5505000000001L137.5919,73.8795000000001L131.8789,70.5455000000001z" Fill="#FFEE4036" 
                      Height="33" Stretch="Fill" UseLayoutRounding="False" Width="36"/>
            </Controls:TimebarItem.Content>
            <Controls:TimebarItem.CursorTemplate>
                <DataTemplate>
                    <Views:VariableView 
                        ToolTipService.ToolTip="{x:Null}"
                        Style="{StaticResource VariableViewDragStyle}"
                        />
                </DataTemplate>
            </Controls:TimebarItem.CursorTemplate>
        </Controls:TimebarItem>

        <Controls:TimebarItem
        	FixedHeight="50"
        	FixedWidth="50"
        	ToolTipService.ToolTip="Insert integer" 
                Margin="5,0,0,0">
            <Controls:TimebarItem.Command>
                <Controls:TimebarCommand TimeCommandType="Value" />
            </Controls:TimebarItem.Command>
            <Controls:TimebarItem.Content>
                <Path Data="F1M177.1963,193.2266C179.8023,193.7066,182.3203,193.6566,183.7673,192.3496C185.3403,190.9296,185.5853,189.5196,185.0143,188.8576C184.2953,188.0256,182.2193,188.2226,179.7913,190.2306C178.6433,191.1756,177.7703,192.1996,177.1963,193.2266 M181.0333,200.4066C182.5093,200.5726,184.2913,200.3336,186.2983,199.4906C188.1273,198.7226,188.7873,197.4586,188.6133,197.0236C188.4733,196.6736,187.1743,196.2896,184.2253,197.4086C182.5073,198.0626,181.4963,199.1856,181.0333,200.4066 M184.8923,206.7876C185.6483,206.9026,186.5023,206.8766,187.4473,206.6756C190.6183,205.9946,191.6713,204.7986,191.7853,204.2616C191.8123,204.1346,191.7973,204.0376,191.6423,203.9236C191.1703,203.5816,189.5703,203.3416,186.8873,204.8886C185.9473,205.4296,185.2713,206.0786,184.8923,206.7876 M190.0143,215.4846L189.2893,215.2206C185.2483,213.7536,182.7933,211.3396,182.5523,208.5956C182.5403,208.4416,182.5333,208.2896,182.5353,208.1366C180.7043,207.2536,179.4923,205.6656,179.0003,203.9996C178.8033,203.3356,178.7063,202.6226,178.7223,201.8966C177.1453,201.3086,175.9543,200.3066,175.2533,199.1466C174.5543,197.9906,174.1913,196.4156,174.5363,194.6586C172.2963,194.0406,170.3183,193.2246,169.1793,192.7126L166.6833,199.4006L175.6703,202.0526L175.1033,203.9706L164.0593,200.7106L168.0763,189.9496L169.0723,190.4516C170.3693,191.1036,172.6933,192.0896,175.1723,192.7616C175.8073,191.4276,176.8773,190.0406,178.5173,188.6876C182.1423,185.6936,185.1523,185.9586,186.5283,187.5506C187.6973,188.9046,187.7503,191.4476,185.1073,193.8336C183.0043,195.7346,179.6513,195.7426,176.4813,195.1196C176.2743,196.1916,176.4253,197.2186,176.9653,198.1136C177.4023,198.8356,178.1203,199.4666,179.0743,199.8906C179.6743,198.1116,181.0713,196.4686,183.5153,195.5396C188.8773,193.5016,190.1933,195.5916,190.4703,196.2816C191.1673,198.0236,189.6743,200.2426,187.0723,201.3356C184.6973,202.3316,182.5513,202.6016,180.7343,202.3786C180.7563,202.7426,180.8183,203.0976,180.9183,203.4336C181.2323,204.4966,181.9343,205.4806,182.9943,206.1176C183.5293,204.9686,184.5153,203.9456,185.8893,203.1546C189.2193,201.2386,191.6523,201.4586,192.8183,202.3066C193.5923,202.8696,193.9363,203.7556,193.7413,204.6776C193.3673,206.4436,191.1713,207.9216,187.8663,208.6306C186.6703,208.8866,185.5783,208.9146,184.5953,208.7676C184.9323,210.4066,186.6273,211.9646,189.2563,213.0626L191.7403,209.4586L197.5863,212.8716L196.5783,214.5996L192.3343,212.1216z" 
                      Fill="#FFBBBDBF" Height="29.101"  Stretch="Fill" Width="33.527"/>
            </Controls:TimebarItem.Content>
            <Controls:TimebarItem.CursorTemplate>
                <DataTemplate>
                    <Views:VariableView 
                        Style="{StaticResource ConstantVariableViewStyle}"
                        />
                </DataTemplate>
            </Controls:TimebarItem.CursorTemplate>
        </Controls:TimebarItem>

        <Controls:TimebarItem
                 FixedHeight="34"            
            FixedWidth="34"
                ToolTipService.ToolTip="Always eventually"
            Margin="5,0,0,0">
            <Controls:TimebarItem.Command>
                <Controls:TimebarCommand TimeCommandType="AlwaysEventually" />
            </Controls:TimebarItem.Command>
            <Controls:TimebarItem.Content>

                <Path Data="F1M268.041,42.4277C266.168,39.8207,264.908,42.5157,261.242,43.4707C258.135,44.2797,257.861,38.7907,254.648,38.7907C251.437,38.7907,251.437,43.4917,248.225,43.4917C245.016,43.4917,243.131,39.8207,241.258,42.4277L252.3,58.3267L252.3,74.6037C252.3,75.9016999999999,253.353,76.9537,254.65,76.9537C255.948,76.9537,257,75.9016999999999,257,74.6037L257,58.3267z" 
                  Fill="#FF37B34A" Height="30" Stretch="Fill" Width="22" UseLayoutRounding="False" Margin="5"/>

            </Controls:TimebarItem.Content>

            <Controls:TimebarItem.CursorTemplate>
                <DataTemplate>
                    <Path Data="F1M268.041,42.4277C266.168,39.8207,264.908,42.5157,261.242,43.4707C258.135,44.2797,257.861,38.7907,254.648,38.7907C251.437,38.7907,251.437,43.4917,248.225,43.4917C245.016,43.4917,243.131,39.8207,241.258,42.4277L252.3,58.3267L252.3,74.6037C252.3,75.9016999999999,253.353,76.9537,254.65,76.9537C255.948,76.9537,257,75.9016999999999,257,74.6037L257,58.3267z" 
                  Fill="#FF37B34A" Height="30" Stretch="Fill" Width="22" UseLayoutRounding="False" Margin="5"/>
                </DataTemplate>
            </Controls:TimebarItem.CursorTemplate>
        </Controls:TimebarItem>

        <!-- Standard buttons work fine. It's the reference to Controls.TimebarItem that fails.
        <ToggleButton 
              IsChecked="{Binding IsActivatorActive, Mode=TwoWay}"
               Style="{StaticResource ToolbarToggleButtonStyle}"
             ToolTipService.ToolTip="Activating Relationship"
            Margin="5,0,0,0" 
             Height="44" >
            <Path Data="F1M391.3428,40.3232L391.3428,42.3232L404.8588,42.3232L374.7098,72.4702L376.1238,73.8852L406.2728,43.7372L406.2728,57.2522L408.2728,57.2522L408.2728,40.3232z" 
                      Fill="#FF231F20" Height="25" Stretch="Fill" Width="25" UseLayoutRounding="False" Margin="5"/>
        </ToggleButton>

        <ToggleButton 
              IsChecked="{Binding IsInhibitorActive, Mode=TwoWay}"
               Style="{StaticResource ToolbarToggleButtonStyle}" Margin="5,0,0,0" 
              Height="44" ToolTipService.ToolTip="Inhibiting Relationship">
            <Path Data="F1M482.25,50.6797L467.725,36.1527L466.311,37.5667L472.867,44.1237L441.912,75.0757L443.326,76.4907L474.281,45.5377L480.836,52.0937z" Fill="#FF231F20" Height="25" Stretch="Fill" Width="25" UseLayoutRounding="False" Margin="5"/>
        </ToggleButton>
        -->
    </StackPanel>

</UserControl>
