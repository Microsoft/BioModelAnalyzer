<!DOCTYPE html>
<html>
<head>
    <title>Client-Side JavaScript Code Sample</title>
    <script src="//js.live.net/v5.0/wl.js"></script>
</head>
<body>
    <div id="signin"></div>
    <label id="info"></label>
    <script>
        WL.Event.subscribe("auth.login", onLogin);
        WL.init({
            client_id: "000000004C12BD9C",
            redirect_uri: "http://bmaclienttest2.azurewebsites.net/html/callback.html",
            scope: "wl.signin",
            response_type: "token"
        });
        WL.ui({
            name: "signin",
            element: "signin"
        });
        function onLogin(session) {
            if (!session.error) {
                WL.api({
                    path: "me",
                    method: "GET"
                }).then(
                    function (response) {
                        document.getElementById("info").innerText =
                            "Hello, " + response.first_name + " " + response.last_name + "!";
                    },
                    function (responseFailed) {
                        document.getElementById("info").innerText =
                            "Error calling API: " + responseFailed.error.message;
                    }
                );
            }
            else {
                document.getElementById("info").innerText =
                    "Error signing in: " + session.error_description;
            }
        }
    </script>
</body>
</html>



<!--<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>OneDrive access sample page</title>
    <script src="../Scripts/jquery-2.1.1.min.js"></script>
    <script src="../Scripts/jquery-ui-1.10.4.min.js"></script>
    <script src="../js/wl.js"></script>

    <script type="text/javascript">

        WL.init({ client_id: "000000004C12BD9C", redirect_uri: "http://bmaclienttest2.azurewebsites.net/bma.client/html/callback.html" });
        WL.Event.subscribe("auth.login", onLogin);
        WL.Event.subscribe("auth.sessionChange", onSessionChange);

        var session = WL.getSession();
        if (session) {
            log("You are already signed in!");
        } else {
            WL.login({ scope: "wl.signin" });
        }

        function onLogin() {
            var session = WL.getSession();
            if (session) {
                log("You are signed in!");
            }
        }

        function onSessionChange() {
            var session = WL.getSession();
            if (session) {
                log("Your session has changed.");
            }
        }

        function log(message) {
            var child = document.createTextNode(message);
            var parent = document.getElementById('JsOutputDiv') || document.body;
            parent.appendChild(child);
            parent.appendChild(document.createElement("br"));
        }

    </script>
</head>
<body>
    <div id="JsOutputDiv"></div>
</body>
</html>-->
