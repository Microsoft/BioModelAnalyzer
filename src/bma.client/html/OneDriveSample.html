<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>OneDrive access sample page</title>
    <script src="../Scripts/jquery-2.1.1.min.js"></script>
    <script src="../Scripts/jquery-ui-1.10.4.min.js"></script>
    <script src="../js/wl.js"></script>

    <script type="text/javascript">

        WL.init({ client_id: "000000004C12BD9C", redirect_uri: "http://localhost:33584/index.html"/*window.location.toString()*/ });
        WL.Event.subscribe("auth.login", onLogin);
        WL.Event.subscribe("auth.sessionChange", onSessionChange);

        var session = WL.getSession();
        if (session) {
            log("You are already signed in!");
        } else {
            WL.login({ scope: "wl.signin" });
        }

        function onLogin() {
            var session = WL.getSession();
            if (session) {
                log("You are signed in!");
            }
        }

        function onSessionChange() {
            var session = WL.getSession();
            if (session) {
                log("Your session has changed.");
            }
        }

        function log(message) {
            var child = document.createTextNode(message);
            var parent = document.getElementById('JsOutputDiv') || document.body;
            parent.appendChild(child);
            parent.appendChild(document.createElement("br"));
        }

    </script>
</head>
<body>
    <button id="connectButton" style="display: none">
        Connect with a Microsoft account
    </button>
</body>
</html>
